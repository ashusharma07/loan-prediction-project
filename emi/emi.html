<!doctype html>
<html>
	<head>
		<title>EMI CALCULATOR</title>
		<meta name="viewport" content="width=device-width,initial-scale=1"> 
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/12.1.0/nouislider.css" rel="stylesheet">
		<link rel="stylesheet" href="emi-style.css">
		<link rel="stylesheet" href="/loan-prediction-project/css/style.css">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
<!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
<!-- Bootstrap core CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
<!-- Material Design Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet" />
    <script src="https://use.fontawesome.com/releases/v5.15.1/js/all.js" crossorigin="anonymous"></script>
	</head>
	<body>
		<section class="header emi-header">
			<nav class="navbar navbar-expand-lg sticky-top navbar-light z-depth-0">
				<a class="navbar-brand ml-5 mt-4" href="../index.html"><img src="https://www.flaticon.com/svg/static/icons/svg/3104/3104993.svg"></a>
				<button class="navbar-toggler first-button" type="button" data-toggle="collapse" data-target="#navbarSupportedContent22"
				  aria-controls="navbarSupportedContent22" aria-expanded="false" aria-label="Toggle navigation">
				  <div class="animated-icon1"><span></span><span></span><span></span></div>
				</button>
				<div class="collapse navbar-collapse" id="navbarSupportedContent22">
				  <ul class="navbar-nav ml-auto pr-2">
				  <li class="nav-item px-4 ">
					<a class="nav-link text-white" href="../index.html">Home
					<span class="sr-only">(current)</span>
					</a>
				  </li>
				  <li class="nav-item px-4">
					<a class="nav-link text-white js-scroll-trigger " href="#contact">Contact</a>
				  </li>
				  
				  </ul>
				</div>
					</nav>
					<div class="container">            
						<h1 class="text-center p-2 amber-text text-uppercase">EMI Calculator</h1>
					</div>
					<div class="container">
					  <div class="row d-flex justify-content-center">
						  <div class="col-md-6">
							  <p class="h3 p-1">Lorem, ipsum dolor sit amet consectetur adipisicing elit. 
								  Quisquam repellendus mollitia est perferendis quam molestiae, enim nostrum a numquam, 
								  aliquid quod soluta repellat facilis consectetur similique nihil! Quod, ipsum in!</p>
						  </div>
						  <div class="col-md-6 p-4 text-center mt-5 p-5">
								  <a class="btn btn-lg peach-gradient js-scroll-trigger" href="#calculate">Calculate</a>
						  </div>
						</div>
					</div>
		</section>
		
		<section class="emi-calculator" id="calculate">
			<h1 class="p-2 font-weight-bolder teal-text">EMI CALCULATOR</h1>
			<div id="loan-container">
				<div id="info-pane" class="box-pane">
					<div class="heading-title bold">Calculate Your Loan.</div>
					<div class="row-input">
						<label>How much would you like to borrow?</label>
						<div class="input-wrap">
							<div class="currency-code">$</div>
							<input type="text" type="number" id="txtLoan" value="1000000"/>
						</div>
					</div>
					<div class="row-input">
						<label>Loan interest rate?</label>
						<div class="input-wrap">
							<div class="percentage-code">%</div>
							<input type="text" type="number" id="txtInterest" value="8.99" maxlength="5" class="short-input"/>
						</div>
					</div>
				
					<div class="row-input">
						<label>How many years would you like the loan for?</label>
						<div id="yearRange" class="range-slider"></div>
					</div>
					<div class="row-input">
						<label>How often would you like to make payments?</label>
						<ul class="ul-buttons">
							<li class="selected" data-value="1">Monthly</li>
							<li data-value="2">Daily</li>
							<li data-value="3">Weekly</li>
						</ul>
					</div>
				</div>
				<div id="graph-pane" class="box-pane">
					<div id="repayment-total">
						<div class="heading-title bold">Total interest</div>
						<div id="repayment-total-value" class="loan-value">
							₹<span id="interest-total">0</span> over <span class="orange-text"><span id="year-value">5</span> years</span>
						</div>
					</div> 
					<div id="repayment-cycle">
						<div class="heading-title bold">Payment would be</div>
						<div id="repayment-cycle-value" class="loan-value">
							₹<span id="repayment-value">0</span> per <span class="orange-text">Daily</span>
						</div>
					</div> 
					
					<div class="clear"></div>
					<div id="graph-chart"></div>
				</div>
			</div>
		</section>
		<section class="contact-section " id="contact">
			<div class="container">
				<div class="row">
					<div class="col-md-4 mb-3 mb-md-0">
						<div class="card py-4 h-100">
							<div class="card-body text-center">
								<i class="fas fa-map-marked-alt text-black mb-2"></i>
								<h4 class="text-uppercase amber-text m-0">Address</h4>
								<hr class="my-4" />
								<div class="small text-black-50">GIET University,Gobriguda</div>
								<div class="small text-black-50">Gunupur</div>
							</div>
						</div>
					</div>
					<div class="col-md-4 mb-3 mb-md-0">
						<div class="card py-4 h-100">
							<div class="card-body text-center">
								<i class="fas fa-envelope text-black mb-2"></i>
								<h4 class="text-uppercase amber-text m-0">Email</h4>
								<hr class="my-4" />
								<div class="small text-black-50"><a class='text-black-50' href="#!">enquiry@giet.edu</a></div>
							</div>
						</div>
					</div>
					<div class="col-md-4 mb-3 mb-md-0">
						<div class="card py-4 h-100">
							<div class="card-body text-center">
								<i class="fas fa-mobile-alt text-black mb-2"></i>
								<h4 class="text-uppercase amber-text m-0">Phone</h4>
								<hr class="my-4" />
								<div class="small text-black-50">+ 91 (637) 023-1308</div>
							</div>
						</div>
					</div>
				</div>
				<div class="social d-flex justify-content-center">
					<a class="mx-2" href="#!"><i class="fab fa-linkedin"></i></a>
					<a class="mx-2" href="#!"><i class="fab fa-facebook-f"></i></a>
					<a class="mx-2" href="#!"><i class="fab fa-kaggle"></i></a>
					<a class="mx-2 " href="#!"><i class="fab fa-github"></i></a>
				</div>
			</div>
		</section>
		<footer class="footer bg-black small text-center text-white-50">
		  <div class="container">Copyright © Lending Rupee 2020</div>
		</footer>
				
	
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/12.1.0/nouislider.js"></script>
		<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
		  <!-- JQuery -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.min.js"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js"></script>
<script src="../js/scripts.js"></script>
		<script type="text/javascript">
		$(document).ready(function () {

$('.first-button').on('click', function () {

  $('.animated-icon1').toggleClass('open');
});
});
			//initial variables
			var loanYear = 20;
			var stepYear = 5;
			var maxLoanYear = 30;
			var paymentCycle = 1;
			var monthlyRepayment = 0;
			var monthlyInterest = 0;
			var amortData = [];
			
			//start up method
			$(function(){
				$(".ul-buttons li").click(function(){
					$(".ul-buttons li").removeClass("selected");
					$(this).addClass("selected");
					paymentCycle = parseInt($(this).attr("data-value"));
					calculateLoan();
				});
				
				//Add on blur event
				$("#txtLoan, #txtInterest").on("blur", function(){
					//Perform a check if loan or interest value has been entered invalid value, if it is, set the default value
					if(isNaN($("#txtLoan").val())) {
						$("#txtLoan").val(1000000);
					}
					
					if(isNaN($("#txtInterest").val())) {
						$("#txtInterest").val(8.99);
					}
					calculateLoan();
				});
			});
			
			//create the noUiSlider
			var range = document.getElementById('yearRange');
			noUiSlider.create(range, {
				range: {
					'min': 5,
					'max': maxLoanYear
				},
				step: stepYear,
				start: [loanYear],
				margin: 300,
				connect: true,
				direction: 'ltr',
				orientation: 'horizontal',
				pips: {
					mode: 'steps',
					stepped: false,
					density: 2
				}
			});
			
			//Add the change event to redraw the graph and calculate loan
			range.noUiSlider.on("change", function(value){
				loanYear = parseInt(value[0]);
				calculateLoan();
			});
			
			//Chart
			google.charts.load('current', {'packages':['corechart']});
			function drawChart() {
				//Hold the loan data array
				var loanData = [];
				
				var dt = new Date();
				var yearCounter = 1;
				
				//Add the graph header
				var headerData = ['Year', 'Interest', 'Interest & Principal', 'Balance'];
				loanData.push(headerData);
				
				for(var i = dt.getFullYear(); i < dt.getFullYear() + loanYear; i++){
					loanData.push([i.toString(), getAmortData("interest", 12 * yearCounter), monthlyRepayment * 12 * yearCounter, getAmortData("balance", 12 * yearCounter)]);
					yearCounter++;
				}
				
				var data = google.visualization.arrayToDataTable(loanData);

				var options = {
				  title: 'Loan Chart',
				  hAxis: {title: 'Year',  titleTextStyle: {color: '#333'}},
				  vAxis: {minValue: 0},
				  pointsVisible: true
				};

				var chart = new google.visualization.AreaChart(document.getElementById('graph-chart'));
				chart.draw(data, options);
			}
			
			//Get amortization data based on type and terms
			function getAmortData(dataType, terms){
				var dataValue = 0;
				switch(dataType){
					case "interest":
						for(var i = 0; i < terms; i++){
							dataValue += parseFloat(amortData[i].Interest);
						}
						break;
					case "balance":
						dataValue = parseFloat(amortData[terms-1].Balance);
						break;
				}
				return Math.round(dataValue);
			}
			
			//calculate function
			function calculateLoan(){
				$("#year-value").html(loanYear);
				var loanBorrow = parseFloat($("#txtLoan").val());
				var interestRate = parseFloat($("#txtInterest").val()) / 1200;
				var totalTerms = 12 * loanYear;
	
				//Monthly
				var schedulePayment = Math.round(loanBorrow * interestRate / (1 - (Math.pow(1/(1 + interestRate), totalTerms))));
				monthlyRepayment = schedulePayment;
				var totalInterestPay = totalTerms * schedulePayment;
				amort(loanBorrow, parseFloat($("#txtInterest").val())/100, totalTerms);
				
				switch(paymentCycle){
					case 2:
						//Fortnightly
						//we multiple by 12 then divided by 52 then multiple by 2
						schedulePayment = Math.round(((schedulePayment * 12) / 52) * 2);
						break;
					case 3:
						//Weekly
						//we multiple by 12 then divided by 52 
						schedulePayment = Math.round((schedulePayment * 12) / 52);
						break;
				}
				
				$("#repayment-value").html(schedulePayment);
				$("#interest-total").html(getAmortData("interest", totalTerms));
				monthlyInterest = (totalInterestPay - loanBorrow) / totalTerms;
				google.charts.setOnLoadCallback(drawChart);
			}
			
			calculateLoan();
			
			//function to calculate the amortization data
			function amort(balance, interestRate, terms)
			{
				amortData = [];
				
				//Calculate the per month interest rate
				var monthlyRate = interestRate/12;
				
				//Calculate the payment
				var payment = balance * (monthlyRate/(1-Math.pow(1+monthlyRate, -terms)));
					
				for (var count = 0; count < terms; ++count)
				{ 
					var interest = balance * monthlyRate;
					var monthlyPrincipal = payment - interest;
					var amortInfo = {
						Balance: balance.toFixed(2),
						Interest: balance * monthlyRate,
						MonthlyPrincipal: monthlyPrincipal
					}
					amortData.push(amortInfo);
					balance = balance - monthlyPrincipal;		
				}
				
			}
		</script>
	
	</body>
</html>